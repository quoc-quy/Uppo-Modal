Uppo.elements=[];function Uppo(options={}){this.opt=Object.assign({closeMethods:["button","overlay","escape"],cssClass:[],destroyOnClose:true,footer:false},options);this.template=document.querySelector(`#${this.opt.templateId}`);if(!this.template){console.error(`#${this.opt.templateId} does not exist!`);return}const{closeMethods:closeMethods}=this.opt;this.allowBackdropClose=closeMethods.includes("overlay");this.allowButtonClose=closeMethods.includes("button");this.allowEscapesClose=closeMethods.includes("escape");this._footerButtons=[];this._handleEscapeKey=this._handleEscapeKey.bind(this)}Uppo.prototype._getScrollbarWidth=function(){if(this._scrollbarWidth){return this._scrollbarWidth}const div=document.createElement("div");Object.assign(div.style,{overflow:"scroll",position:"absolute",top:"-999px"});document.body.appendChild(div);this._scrollbarWidth=div.offsetWidth-div.clientWidth;document.body.removeChild(div);return this._scrollbarWidth};Uppo.prototype._build=function(){const content=this.template.content.cloneNode(true);this._backdrop=document.createElement("div");this._backdrop.className="uppo__backdrop";const container=document.createElement("div");container.className="uppo__container";this.opt.cssClass.forEach(className=>{if(typeof className==="string"){container.classList.add(className)}});if(this.allowButtonClose){const closeBtn=this._createButton("&times;","uppo__close",()=>this.close());container.append(closeBtn)}const modalContent=document.createElement("div");modalContent.className="uppo__content";modalContent.append(content);container.append(modalContent);if(this.opt.footer){this._modalFooter=document.createElement("div");this._modalFooter.className="uppo__footer";this._renderFooterContent();this._renderFooterButton();container.append(this._modalFooter)}this._backdrop.append(container);document.body.append(this._backdrop)};Uppo.prototype.open=function(){Uppo.elements.push(this);if(!this._backdrop){this._build()}setTimeout(()=>{this._backdrop.classList.add("uppo--show")},0);if(this.allowBackdropClose){this._backdrop.onclick=e=>{if(e.target===this._backdrop){this.close()}}}if(this.allowEscapesClose){document.addEventListener("keydown",this._handleEscapeKey)}this._onTransitionEnd(this.opt.onOpen);document.body.classList.add("uppo--no-scroll");document.body.style.paddingRight=this._getScrollbarWidth()+"px";return this._backdrop};Uppo.prototype._handleEscapeKey=function(e){if(e.key==="Escape"){const lastModal=Uppo.elements[Uppo.elements.length-1];if(lastModal===this){this.close()}}};Uppo.prototype.setFooterContent=function(html){this._footerContent=html;this._renderFooterContent()};Uppo.prototype.addFooterButton=function(title,cssClass,callback){const button=this._createButton(title,cssClass,callback);this._footerButtons.push(button);this._renderFooterButton()};Uppo.prototype._renderFooterContent=function(){if(this._modalFooter&&this._footerContent){this._modalFooter.innerHTML=this._footerContent}};Uppo.prototype._renderFooterButton=function(){if(this._modalFooter){this._footerButtons.forEach(btn=>{this._modalFooter.append(btn)})}};Uppo.prototype._createButton=function(title,cssClass,callback){const button=document.createElement("button");button.className=cssClass;button.innerHTML=title;button.onclick=callback;return button};Uppo.prototype._onTransitionEnd=function(callback){this._backdrop.ontransitionend=e=>{if(e.propertyName!=="opacity")return;if(typeof callback==="function")callback()}};Uppo.prototype.close=function(destroy=this.opt.destroyOnClose){Uppo.elements.pop();this._backdrop.classList.remove("uppo--show");if(this.allowEscapesClose){document.removeEventListener("keydown",this._handleEscapeKey)}this._onTransitionEnd(()=>{if(this._backdrop&&destroy){this._backdrop.remove();this._backdrop=null;this._modalFooter=null}if(!Uppo.elements.length){document.body.classList.remove("uppo--no-scroll");document.body.style.paddingRight=""}if(typeof this.opt.onClose==="function")this.opt.onClose()})};Uppo.prototype.destroy=function(){this.close(true)};